{% extends 'base.html' %}
{% block title %}  My courses  {% endblock %}
  {% block content %}
  <div class="my-5 pt-3 pb-5">
    {% if messages %}
      {% for message in messages %}
      <div class="alert alert-warning alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      {% endfor %}
    {% endif %}

    <div class="row">
      <div class="col-md-2 d-none d-md-block bg-secondary px-2">
        {% if request.user.userprofile.role == 'admin' %}
          {% include 'admin_app/admin_navbar.html' %}
        {% elif request.user.userprofile.role == 'teacher' and request.user.userprofile.position == 'head' %}
          {% include 'accounts/head_navbar.html' %}
        {% elif request.user.userprofile.role == 'teacher' and request.user.userprofile.position is None %}
          {% include 'accounts/teacher_navbar.html' %}
        {% elif request.user.userprofile.role == 'student' %}
          {% include 'accounts/student_navbar.html' %}
        {% endif %}
      </div>
      <div class="col-md-10 py-5" style="max-width: 80%; background-color: rgb(40, 109, 109); margin: 0 auto;">
        <h2 class="text-center">
          {% if profile.user.first_name %}
            Hi, {{ profile.user.first_name|capfirst }} {{ profile.user.last_name|capfirst }} !
          {% else %}
            Hi, {{ profile.user.username }}
          {% endif %}
        </h2>
        <p>Courses you have registered for</p>
        <table class="table table-dark table-responsive">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Course Code</th>
              <th scope="col"> Course name </th>
              <th scope="col">Department</th>
              <th scope="col">Year</th>
              <th scope="col">Semester</th>
              <th scope="col">Teacher</th>
              <th scope="col">View result</th>
            </tr>
          </thead>
          <tbody>
            {% for course in courses %}
              <tr>
                <th scope="row">{{ forloop.counter }}</th>
                <td><a class="bg-primary text-white p-1 rounded" href="{% url 'course-detail' course_code=course.course_code %}">{{ course.course_code }}</a></td>
                <td>{{ course.name }}</td>
                <td>{{ course.department.name }}</td>
                <td>{{ course.academic_year }}</td>
                <td> {{ course.semester }} </td>
                <td>
                  {% for teacher in course.teachers.all %}
                    <a class="text-white bg-primary p-1 rounded" href="{% url 'teacher-detail' teacher_id=teacher.id %}">{{ teacher.user.username }}{% if not forloop.last %}, {% endif %}</a>
                  {% endfor %}
                </td>
                <td>
                  <a class="bg-primary text-white p-1 rounded" href="{% url 'view-result' course_code=course.course_code %}">View result</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  {% endblock %}
